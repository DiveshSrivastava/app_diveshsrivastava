Started by user Kalp
Obtained Jenkinsfile from git https://github.com/DiveshSrivastava/app_diveshsrivastava.git
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git.exe rev-parse --resolve-git-dir C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\.git # timeout=10
Fetching changes from the remote Git repository
 > git.exe config remote.origin.url https://github.com/DiveshSrivastava/app_diveshsrivastava.git # timeout=10
Fetching upstream changes from https://github.com/DiveshSrivastava/app_diveshsrivastava.git
 > git.exe --version # timeout=10
 > git --version # 'git version 2.37.0.windows.1'
 > git.exe fetch --tags --force --progress -- https://github.com/DiveshSrivastava/app_diveshsrivastava.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git.exe rev-parse "refs/remotes/origin/develop^{commit}" # timeout=10
Checking out Revision 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 (refs/remotes/origin/develop)
 > git.exe config core.sparsecheckout # timeout=10
 > git.exe checkout -f 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 # timeout=10
Commit message: "jenkins file format"
 > git.exe rev-list --no-walk 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Nuget restore)
[Pipeline] echo
Cloning repository ..
[Pipeline] git
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git.exe rev-parse --resolve-git-dir C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\.git # timeout=10
Fetching changes from the remote Git repository
 > git.exe config remote.origin.url https://github.com/DiveshSrivastava/app_diveshsrivastava.git # timeout=10
Fetching upstream changes from https://github.com/DiveshSrivastava/app_diveshsrivastava.git
 > git.exe --version # timeout=10
 > git --version # 'git version 2.37.0.windows.1'
 > git.exe fetch --tags --force --progress -- https://github.com/DiveshSrivastava/app_diveshsrivastava.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git.exe rev-parse "refs/remotes/origin/develop^{commit}" # timeout=10
Checking out Revision 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 (refs/remotes/origin/develop)
 > git.exe config core.sparsecheckout # timeout=10
 > git.exe checkout -f 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 # timeout=10
 > git.exe branch -a -v --no-abbrev # timeout=10
 > git.exe branch -D develop # timeout=10
 > git.exe checkout -b develop 15c0a5c8b53479a6fa50d18af4bd3dd620bfbec3 # timeout=10
Commit message: "jenkins file format"
[Pipeline] echo
Restoring packages ..
[Pipeline] bat

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop>dotnet restore 
  Determining projects to restore...
  All projects are up-to-date for restore.
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Code build)
[Pipeline] echo
Building solution ..
[Pipeline] bat

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop>dotnet build 
Microsoft (R) Build Engine version 17.1.1+a02f73656 for .NET
Copyright (C) Microsoft Corporation. All rights reserved.

  Determining projects to restore...
  All projects are up-to-date for restore.
  nagp-devops-us -> C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\nagp-devops-us\bin\Debug\netcoreapp3.1\nagp-devops-us.dll
  nagp-devops-us -> C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\nagp-devops-us\bin\Debug\netcoreapp3.1\nagp-devops-us.Views.dll
  test-project -> C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\test-project\bin\Debug\netcoreapp3.1\test-project.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:02.36
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Release artifacts)
[Pipeline] echo
Publishing artifacts ..
[Pipeline] bat

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop>cd nagp-devops-us 

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\nagp-devops-us>docker image build -t kalpdeep/i-diveshsrivastava-develop:latest . 
#1 [internal] load build definition from Dockerfile
#1 sha256:2f6ca93144cef64e12c63a7e333e4339fbf05a92b6fd912b71337059b192b5d0
#1 transferring dockerfile: 32B done
#1 DONE 0.0s

#2 [internal] load .dockerignore
#2 sha256:21c397ef72552f9252113556b9ac9f032ae8c466d50c5daf737d41960329b491
#2 transferring context: 35B done
#2 DONE 0.0s

#3 [internal] load metadata for mcr.microsoft.com/dotnet/sdk:3.1
#3 sha256:ce64eac29b07ebbf4d973b99e492aaf8ba85556a3d349a716d703b36362d10a7
#3 DONE 0.6s

#4 [internal] load metadata for mcr.microsoft.com/dotnet/aspnet:3.1
#4 sha256:6cc59bb059858e4ec7070d9fc240ac93870aa8bdfd5679ab219e693360eb146a
#4 DONE 0.6s

#10 [internal] load build context
#10 sha256:fe1bb05e19c68db5b10c2c5fd481623cb067aa91597cb013ebc7cd2b83aad13c
#10 DONE 0.0s

#5 [base 1/2] FROM mcr.microsoft.com/dotnet/aspnet:3.1@sha256:ff64b110039e488fbf0851fc4754a3de6d1ece9d033bc652f4ee2b053f1f0e4c
#5 sha256:1ece0b9c9dc386f727ac93739f88aa9fb18a8c8a93d880fe37a355f1b27b3877
#5 resolve mcr.microsoft.com/dotnet/aspnet:3.1@sha256:ff64b110039e488fbf0851fc4754a3de6d1ece9d033bc652f4ee2b053f1f0e4c
#5 resolve mcr.microsoft.com/dotnet/aspnet:3.1@sha256:ff64b110039e488fbf0851fc4754a3de6d1ece9d033bc652f4ee2b053f1f0e4c 0.0s done
#5 DONE 0.0s

#8 [build 1/7] FROM mcr.microsoft.com/dotnet/sdk:3.1@sha256:61755be2b565a90f84f17dcc9d0bc40f56f0b6c9c5a80b2f320e902fa543ffdc
#8 sha256:adf867c3b52b1361fc0572adf87a9be0f9ab35e4a424f345e3cee21dd842e902
#8 resolve mcr.microsoft.com/dotnet/sdk:3.1@sha256:61755be2b565a90f84f17dcc9d0bc40f56f0b6c9c5a80b2f320e902fa543ffdc 0.0s done
#8 DONE 0.0s

#10 [internal] load build context
#10 sha256:fe1bb05e19c68db5b10c2c5fd481623cb067aa91597cb013ebc7cd2b83aad13c
#10 transferring context: 3.84kB 0.0s done
#10 DONE 0.1s

#11 [build 3/7] COPY [nagp-devops-us.csproj, ./]
#11 sha256:af78f2fa33e0e8f040798edf8fd63c741846f0f3de08eaa5fe6f2f279deeacc2
#11 CACHED

#12 [build 4/7] RUN dotnet restore "nagp-devops-us.csproj"
#12 sha256:8c08e19a1599d151837237d2cca90196412fc11784c0b988f9738403febdbd52
#12 CACHED

#6 [base 2/2] WORKDIR /app
#6 sha256:cf7855635f8f605c68422c1b2599bfe9b161b7ce4b1b3bd992501fa3f68df98b
#6 CACHED

#7 [final 1/2] WORKDIR /app
#7 sha256:0b34241cdd433e038a58012bde096e961b1584d5b877974f88b9e3a6c3e18078
#7 CACHED

#14 [build 6/7] WORKDIR /src
#14 sha256:1293c7d6d7f6d1007eb4d541ec0f63154644e0ce3ed177118488bcd082e4e79d
#14 CACHED

#9 [build 2/7] WORKDIR /src
#9 sha256:8479116fb3929d0c73315ad52f7ce401625295ed4f15083b953c1f36fc69f733
#9 CACHED

#16 [publish 1/1] RUN dotnet publish "nagp-devops-us.csproj" -c Release -o /app/publish /p:UseAppHost=false
#16 sha256:57d96eda263c165fef3b3c59254a9489c947055d3bdbd8849a9947b6db4317d0
#16 CACHED

#15 [build 7/7] RUN dotnet build "nagp-devops-us.csproj" -c Release -o /app/build
#15 sha256:225fcff868168e42f82b63745d1d7e6f3a951a428f73bbf1a1ed0825be4f6901
#15 CACHED

#13 [build 5/7] COPY . .
#13 sha256:9e0234bce26520adcf7ec7c9ea8262cee760b88f275cfe5988d561bf405ef1be
#13 CACHED

#17 [final 2/2] COPY --from=publish /app/publish .
#17 sha256:a8ea12dcd8f6b2860de976445ed210f94dc4867a19ac1de64b29e860f7314892
#17 CACHED

#18 exporting to image
#18 sha256:e8c613e07b0b7ff33893b694f7759a10d42e180f2b4dc349fb57dc6b71dcab00
#18 exporting layers done
#18 writing image sha256:d4811e94627f9bcddf6a79415aeab23a2a99ba2a21b230e12a1ec1fe791cad0b done
#18 naming to docker.io/kalpdeep/i-diveshsrivastava-develop:latest done
#18 DONE 0.0s

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\nagp-devops-us>docker push kalpdeep/i-diveshsrivastava-develop:latest  
The push refers to repository [docker.io/kalpdeep/i-diveshsrivastava-develop]
be4369a3ca6b: Preparing
5f70bf18a086: Preparing
a74920d478bb: Preparing
eab59045b4de: Preparing
005581d25563: Preparing
99f702cc7137: Preparing
5033e326766e: Preparing
735956b91a18: Preparing
5033e326766e: Waiting
735956b91a18: Waiting
5f70bf18a086: Layer already exists
005581d25563: Layer already exists
eab59045b4de: Layer already exists
a74920d478bb: Layer already exists
be4369a3ca6b: Layer already exists
99f702cc7137: Layer already exists
735956b91a18: Layer already exists
5033e326766e: Layer already exists
latest: digest: sha256:ff0d6e0ef9579d896b380439009738c1a0562639cbde0e60040c56b8ff46942c size: 1998
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Kubernetes deployments)
[Pipeline] echo
K8s deployment  ..
[Pipeline] bat

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop>cd K8s 

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\K8s>kubectl create -f namespace.yaml  
Error from server (AlreadyExists): error when creating "namespace.yaml": namespaces "kubernetes-cluster-diveshsrivastava" already exists

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\K8s>kubectl apply -f configmap.yaml  
configmap/env-configmap-develop created

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\K8s>kubectl apply -f secrets.yaml  
secret/env-secrets-develop created

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\K8s>kubectl apply -f service.yaml  
service/i-diveshsrivastava-develop-service created

C:\Users\Admin\AppData\Local\Jenkins\.jenkins\workspace\nagp_dotnet_diveshsrivastava_develop\K8s>kubectl apply -f deployment.yaml  
deployment.apps/i-diveshsrivastava-develop created
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
